# https://taskfile.dev

version: '3'

tasks:
  native:
    desc: "Builds the current go module for running on local machine."

    vars:
      out: '{{.o | default "main"}}'

    cmds:
      - go build -o {{.out}} .

    dir: '{{.USER_WORKING_DIR}}'
  
  test:
    desc: "Runs the current go module natively."

    cmds:
      - go run .

    dir: '{{.USER_WORKING_DIR}}'

  build:
    desc: "Builds the current go module for deployment on an EV3."

    vars:
      out: '{{.o | default "main"}}'

    cmds:
      - GOOS=linux GOARCH=arm GOARM=5 go build -ldflags="-s -w" -o {{.out}} .

    dir: '{{.USER_WORKING_DIR}}'